"use strict";function wrapper(a){function b(b,c,d){var g=process.hrtime(c);g=1e9*g[0]+g[1];var h=b._bytesDispatched*a["byte"]/a.misura;return d===!0&&(e=new Array(2),f._bytesDispatched=0),(h/(g/a.time)).toFixed(1)+a.out}function c(b,c,d){var g=process.hrtime(c);g=1e9*g[0]+g[1];var h=b.bytesRead*a["byte"]/a.misura;return d===!0&&(e=new Array(2),f.bytesRead=0),(h/(g/a.time)).toFixed(1)+a.out}var d=b;a.response||(d=c);var e=new Array(2),f={_bytesDispatched:0,bytesRead:0};return function(a,b){function c(){f._bytesDispatched+=k._bytesDispatched,f.bytesRead+=k.bytesRead}function g(){return h(),void 0!==e[1]?(f._bytesDispatched+=k._bytesDispatched,f.bytesRead+=k.bytesRead,a.transferRate=d(f,e,!0),a.transferRate):void 0}function h(){k.removeListener("close",c)}if(null===a||"object"!=typeof a)throw new TypeError("req required");if(null===b||Array.isArray(b)===!1)throw new TypeError("start required");var i=a.res;void 0===e[1]&&(e=b);var j=i.finished||i.socket&&i.socket.writable===!1;if(j===!0)return a.transferRate=d(a.socket,e),a.transferRate;var k=a.socket;k.once("close",g)}}function transfer(a){var b=a||Object.create(null),c={misura:1024,"byte":1,out:" KB/s",time:1e9,response:!0};return"Byte"==b.data?(c.misura=1,c["byte"]=1,c.out=" Byte"):"KB"==b.data?(c.misura=1024,c["byte"]=1,c.out=" KB"):"MB"==b.data?(c.misura=1048576,c["byte"]=1,c.out=" MB"):"bit"==b.data?(c.misura=1,c["byte"]=8,c.out=" bit"):"Kb"==b.data?(c.misura=1e3,c["byte"]=8,c.out=" Kbit"):"Mb"==b.data&&(c.misura=1e6,c["byte"]=8,c.out=" Mbit"),"nanosecond"==b.time?(c.time=1,c.out+="/ns"):"millisecond"==b.time?(c.time=1e6,c.out+="/ms"):"second"==b.time&&(c.time=1e9,c.out+="/s"),b.response===!1&&(c.response=!1),b.output===!1&&(c.out=""),wrapper(c)}module.exports=transfer;
